---
layout: post
title: "串行控制流水灯"
date: 2009-02-28  15:51
comments: true
categories: tech
tags: ["Scm"]
_baiduhi_id: 967eaec2c20ad0130ff47762.html
_baiduhi_category: Scm
---

(hplonline)2009.2.28<br/><br/>
好吧。。又是灯。。因为这个玩起来简洁啊。。这一盘我是来练串口的。。<br/><br/><font color="#0000ff">一。电路图：</font><br/><div forimg="1"><img border="0" class="blogimg" small="0" src="http://hiphotos.baidu.com/hplonline/pic/item/2571093bc30b64ca14cecbad.jpg"/><br/><br/>
在串行工作0方式下<br/>
用TXD输出时间信号<br/>
用RXD输出数据<br/>
所以这么接嘛。。</div>
<br/><font color="#0000ff">二。代码</font><br/><br/>
org 00h<br/>
ljmp main<br/><br/>
org 30h<br/>
main:<br/><br/>
      mov SCON , #00h<br/>
      mov A , #1h<br/>
      out:<br/>
      mov SBUF , A<br/>
      wait:<br/>
      jnb TI , wait<br/>
      clr TI<br/>
      acall delay<br/>
      rl A<br/>
      sjmp out <br/><br/>
sjmp $<br/><br/>
delay:<br/>
mov R5,#10<br/>
D3:<br/>
mov R7,#100<br/>
D1:<br/>
MOV R6,#200<br/>
D2:<br/>
djnz R6,D2<br/>
djnz R7,D1<br/>
djnz R5,D3<br/>
ret<br/><br/>
end<br/><br/>
嗯，delay和前两个一样的了。。连我都觉得有点熟悉了。。<br/><br/>
mov SCON , #00h<br/>
选择好工作模式0，具体SCON的每位的含义网上也多<br/><br/>
下面就是用A来做循环移位，然后把每次的8位输出就行了<br/>
      out:<br/>
      mov SBUF , A<br/>
。。。<br/>
      rl A<br/>
      sjmp out <br/><br/>
输出了之后，一直忙等待TI，置位表示输出完毕，所以<br/>
      wait:<br/>
      jnb TI , wait<br/><br/>
最后清除TI，供下次使用，并调用延迟，使灯流动可见<br/>
      clr TI<br/>
      acall delay<br/><br/>
嗯。。就是这样。。练个串口而已。。<br/><br/><font color="#ff6600">之所以是汇编。。因为更能看清楚一些东西。。</font>
