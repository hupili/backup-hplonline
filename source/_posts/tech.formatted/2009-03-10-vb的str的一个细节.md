---
layout: post
title: "vb的str的一个细节"
date: 2009-03-10  22:35
comments: true
categories: tech
tags: ["Vb"]
_baiduhi_id: 24c0cc5c2662494bfaf2c028.html
_baiduhi_category: Vb
---

(hplonline)2009.3.10<br/><br/>
在知道上看到有人问：<br/><br/>
vb中len(str（val("123.4"）））的值多少？请说清楚点<br/><br/>
而马上就有人想当然地跟帖。。。无语。。。<br/><br/>
直观感觉以为是5，其实是6。。<br/><br/><span><cn>因为str执行完后前面还有一个空格 <br/><br/>
是“ 123.4” <br/><br/><font color="#ff0000">MSDN</font>上面解释清楚了: <br/><br/><em>返回代表一数值的 Variant (String)。 <br/><br/>
语法 <br/><br/>
Str(number) <br/><br/>
必要的 number 参数为一 Long，其中可包含任何有效的数值表达式。 <br/><br/>
说明 <br/><br/>
当一数字转成字符串时，总会在前头保留一空位来表示正负。如果 number 为正，返回的字符串包含一前导空格暗示有一正号。 <br/><br/>
使用 Format 函数可将数值转成必要的格式，如日期、时间、货币或其他用户自定义格式。与 Str 不同的是，Format 函数不包含前导空格来放置 number 的正负号。 <br/><br/>
注意   Str 函数只视句点 (.) 为有效的小数点。如果使用不同的小数点（例如，国际性的应用程序），可使用 CStr 将数字转成字符串。</em>       </cn></span>
