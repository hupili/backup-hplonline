---
layout: post
title: "PWM和调压法对直流电机的控制"
date: 2009-03-22  22:48
comments: true
categories: tech
tags: ["Scm"]
_baiduhi_id: 8420dbc8d59cfe1f7e3e6f68.html
_baiduhi_category: Scm
---

(hplonline)2009.3.22<br/><br/>
这回的目标就是直流电机。<br/><br/><font color="#0000ff">一。原理</font><br/><br/>
用我的口水话来描述。直流电机大致是这么个东西。<br/><br/><font color="#ff0000">你给他通上电他就会转啦，转的方向取决于电流的方向。<br/>
转的速度，可以说跟电压相关，也可以说跟电流相关。<br/>
（网上可以搜到那些公式，有电压，有磁通，磁通是跟电流相关的）</font><br/><br/>
所以，有两种很明显的控制方法：<br/><font color="#ff6600">1.我一会通电，一会断电，那么他就走走停停，把时间控制好点，宏观上就是很平稳地转了。<br/>
2.我要他转多快，我给多少的电压，或者电流，这样。</font><br/><br/>
一般提到直流电机，大家都会提到的PWM就是第1种这个意思。<br/>
给个方波，调节下占空比，就相当于开开关关这样。<br/>
开得多自然就跑得快点，开得少就慢点。<br/><br/><font color="#ff9900">然后这里为了好玩，再用下第二种方法。</font><br/><br/><font color="#0000ff">二。电路</font><br/><br/>
右半部分如下。<br/><br/><div forimg="1"><img border="0" class="blogimg" small="0" src="http://hiphotos.baidu.com/hplonline/pic/item/ccbe5c4e7e287628b2de0518.jpg"/><br/><br/>
这个<a href="http://hi.baidu.com/hplonline/blog/item/8065aaece104673527979195.html" target="_blank">DAC0808</a>就是前面那一篇用过的了。这里把LED换成MOTOR。<br/><br/><font color="#ff0000">要提下的就是，MOTOR的参数里面可以设置转速，默认是6，可以改大一点，要不速度变化过于细微</font>。<br/><br/>
左下的这个MOTOR是用PWM控制的。<br/><br/>
下面是左边的图：</div>
<div forimg="1"><img border="0" class="blogimg" small="0" src="http://hiphotos.baidu.com/hplonline/pic/item/50de9d0ace3e823e94ca6b18.jpg"/></div>
<br/>
这里涉及到的也就是<a href="http://hi.baidu.com/hplonline/blog/item/a8f8c2fc579ce6f5fd037f20.html" target="_blank">ADC0808</a>的使用。<br/><br/>
那么整个流程就是，采样左边的电阻上的电压，用来调节MOTOR的转速。<br/><br/><font color="#0000ff">三。程序</font><br/><br/>
#include &lt;reg51.h&gt;<br/><br/>
sbit CLOCK = P3 ^ 0 ;<br/>
sbit START = P3 ^ 1 ;<br/>
sbit EOC = P3 ^ 2 ;<br/>
sbit OE = P3 ^ 3 ;<br/>
sbit PWM = P3 ^ 4 ;<br/><br/>
void delay(unsigned char c);<br/><br/>
void main(){<br/>
      unsigned char c ;<br/>
      TMOD = 0x02 ;<br/>
      TH0 = 0x20 ;<br/>
      TL0 = 0x00 ;<br/>
      IE = 0x82 ;<br/>
      TR0 = 1;<br/>
      while(1){<br/>
            START = 1 ;<br/>
            START = 0 ;<br/>
            while ( !EOC ) ;<br/>
            OE = 1 ;<br/>
            c = P1 ;<br/>
            P2 = c       ;<br/>
            PWM = 1 ;<br/>
            delay(c);<br/>
            PWM = 0 ;<br/>
            delay( 255 - c );<br/>
            OE = 0 ;<br/>
      }      <br/>
}<br/><br/>
void delay(unsigned char c){<br/>
      while ( c -- ) ;<br/>
}<br/><br/>
void timer0() interrupt 1{<br/>
      CLOCK = !CLOCK ;<br/>
}<br/><br/>
跟前面一篇ADC的有点不同就是让单片机自己输出CLOCK信号。<br/><br/>
这个实验主要就是直流电机的一点东西，其他部分还是之前做过的实验的一个<font color="#ff0000">组装</font>。
