---
layout: post
title: "mutable(c++)"
date: 2009-04-13  19:32
comments: true
categories: tech
tags: ["c","c++"]
_baiduhi_id: 8fc50d08b6a27538e82488e9.html
_baiduhi_category: c&c++
---

(hplonline)2009.4.13<br/><br/>
首先，要知道const对函数的修饰。<br/><br/>
当我们<font color="#ff0000">用const修饰一个成员函数的时候，<br/>
表示该函数不会改变该类的状态。</font><br/>
关于“状态”，我觉得可以理解为所有成员变量的值。<br/><br/>
比如我们设计一个获取数据的元素。<br/>
int readdata()const {<br/>
我们的期望是他不改变类中数据域的值，所以用const修饰。<br/><br/>
假设我们现在要这样一个功能。<br/><font color="#ff6600">一方面，我们可以从readdata()得到数据。<br/>
另一方面，我们要知道这个数据有没有被读取过。</font><br/><br/>
那么写出如下代码：<br/><br/>
class cls{<br/>
private :<br/>
      bool data_has_been_read ;<br/>
      int data;<br/>
      cls():data_has_been_read(false),data(0){};<br/>
      int readdata()const {<br/>
            data_has_been_read = true ;<br/>
            return data ;<br/>
      }<br/>
};<br/><br/>
显然，由于const对readdata的修饰，这段代码编译报错：<br/>
l-value specifies const object<br/><br/>
那么，我又偏偏想实现这个功能，<br/>
同时我又想readdata具有不改变该类状态的语义（即不得去掉const）<br/>
（这里我们关心的是data本身，只要data不改变，即认为类的状态没有改变，<br/>
而不关心一个该data是否被读取过的标记）<br/><br/>
所以C++给出了mutable 这样一个东西。<br/><br/>
如下改动：<br/><br/>
class cls{<br/>
private :<br/>
      <font color="#ff0000">mutable</font> bool data_has_been_read ;<br/>
      int data;<br/>
      cls():data_has_been_read(false),data(0){};<br/>
      int readdata()const {<br/>
            data_has_been_read = true ;<br/>
            return data ;<br/>
      }<br/>
};<br/><br/>
这时，这个类就通过编译了。<br/><br/>
下面是lingoes上查下该单词的意思：<br/><br/><div style="margin: 0px 0px 5px; color: rgb(128, 128, 128); line-height: normal;"><span style="font-size: 10.5pt; color: rgb(0, 0, 0); line-height: normal;"><strong>mutable</strong></span>   <span style="font-size: 10.5pt; line-height: normal;">[<font color="#009900">mu·ta·ble || 'mjuːtəbl</font>]</span></div>
<div style="margin: 0px 0px 5px;">
<div style="margin: 4px 0px;"><font color="#c00000">adj.</font>  易变的,  性情不定的</div>
</div>
<br/><div style="margin: 0px 0px 5px; color: rgb(128, 128, 128); line-height: normal;"><span style="font-size: 10.5pt; color: rgb(0, 0, 0); line-height: normal;"><strong>volatile</strong></span>   <span style="font-size: 10.5pt; line-height: normal;">[<font color="#009900">vol·a·tile || 'vɑlətl /'vɒlətaɪl</font>]</span></div>
<div style="margin: 0px 0px 5px;">
<div style="margin: 4px 0px;"><font color="#c00000">adj.</font>  挥发性的, 不稳定的,  可变的</div>
</div>
<br/>
同时，上一篇用的<a href="http://hi.baidu.com/hplonline/blog/item/baf29d2bb27a5ff2e7cd400b.html" target="_blank">volatile</a>也给出来了。<br/><br/>
感觉他们的意思也差不多，那么创始人是怎么选择单词的呢。。<br/>
看来我们对C++的肤浅认识正如我们不理解英语一样。。
