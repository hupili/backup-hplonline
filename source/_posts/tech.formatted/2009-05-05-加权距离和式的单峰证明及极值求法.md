---
layout: post
title: "加权距离和式的单峰证明及极值求法"
date: 2009-05-05  18:37
comments: true
categories: tech
tags: ["Math"]
_baiduhi_id: 0ba65b0f469149226159f33f.html
_baiduhi_category: Math
---

(<a href="http://hi.baidu.com/withyhs" target="_blank">yhsa678</a>&amp;hplonline)2009.5.5<br/><br/>
开始在提到《<a href="http://hi.baidu.com/hplonline/blog/item/0035a3ecf6dbfe2f63d09fdf.html" target="_blank">残差绝对和最小的拟合准则</a>》时，<br/>
碰到了这样一个式子：<br/><br/><div forimg="1"><img border="0" src="http://hiphotos.baidu.com/hplonline/pic/item/dd5566815817dbfbbd3e1e4f.jpg" small="0" class="blogimg"/></div>
<br/>
想求他的极值，除了提到过的用<font color="#ff0000">黄金三分法</font>求外，<br/>
希望寻求一种更高效的，更精确的解答方式。<br/><br/>
事实证明我比较愚钝，楞是没有想到。。<br/>
在请教了<a href="http://hi.baidu.com/withyhs" target="_blank">yhsa678</a>后茅塞顿开，<br/>
发现我之前一直被“距离”的概念束缚了，怎么也没走出那个圈子。<br/>
之所以会得到这样一个概念，因为之前接触过类似的简化版问题。<br/>
可见经验的积累往往给人的创造力造成损害。。。<br/><br/>
而在证明该式的单峰性的同时，即可给出极值的求法。。<br/>
（如此顺手牵羊的事情我都没做到，悲哀啊。。）<br/><br/><font color="#0000ff">加权距离和式：</font><br/>
这个名字并非无厘头的。<br/>
我们令所有ai=1。<br/><br/>
得到的f(x)即为x到各个bi的距离的和。可以认为是一个距离和式。<br/>
（我所谓的简化版就是这个）<br/><br/>
那么在这些距离前面乘上系数ai。可认为是对到每点的距离加权。<br/><br/>
这个定义在解决此篇的函数问题中并无大用，仅仅是为后续文章的叙述方便。<br/><font color="#0000ff"><br/>
单峰：</font><br/><br/>
下凹的单峰：<br/><font size="4">f'(x)&lt;=0</font>对所有x&lt;x0成立，<br/><font size="4">f'(x)&gt;=0对</font>所有x&gt;x0成立，<br/><br/>
x0就是要求的极值点。<br/><br/>
上凸的类似。<br/><br/><font color="#0000ff">单峰证明：</font><br/><br/>
注意到绝对值函数的性质。<br/>
|x-bi|<br/>
在尖点bi处是不可导的，但尖点左侧导数为负，右侧为正。<br/><br/>
这样，选择最小bi左侧的一点l,最大bi右侧的一点r<br/>
那么f'(l)&lt;0,f'(r)&gt;0<br/><br/>
并且，当x从l变化到r的时候，每经过一个尖点，f'(x)的值只能增加。<br/>
于是<font color="#ff0000">一定存在某点x0，他左边f'(x)&lt;0,右边f'(x)&gt;0</font><br/><br/>
呵呵，口水话证明。。。<br/><br/><font color="#0000ff">极值求法：</font><br/><br/>
从上面的证明直接得出，那个x0就是要求的极值点。<br/><br/>
这样，可以先把n个点按bi排序，然后线性扫描一次，<br/>
做个定义：<br/><div forimg="1"><img border="0" src="http://hiphotos.baidu.com/hplonline/pic/item/96aee1f862bb922cdbf9fd61.jpg" small="0" class="blogimg"/></div>
j从0开始取n<br/><br/><div forimg="1"> </div>
于是找到某个g(j)&lt;=0&amp;&amp;g(j+1)&gt;=0<br/><br/>
则b(j+1)就是要求的极值点。<br/><br/><font color="#0000ff">效率比较：</font><br/><br/>
1.加权距离和式：O(排序)+O(n)<br/><br/>
2.黄金三分：O(ln(dl/l)/ln(0.618))<br/>
l是三分区间的长度<br/>
dl是允许的误差容限（即最后给出的极值点落在的区间的长度）<br/><br/>
1法在时间上是比较确定的，而且能求出精确解<br/>
2法在误差容限较大的时候可以较快出解
