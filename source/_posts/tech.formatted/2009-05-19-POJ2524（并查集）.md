---
layout: post
title: "POJ2524（并查集）"
date: 2009-05-19  12:45
comments: true
categories: tech
tags: ["算法"]
_baiduhi_id: bd4524dd0463bcd18c1029c6.html
_baiduhi_category: 算法
---

(hplonline)2009.5.19<br/><br/>
没事水点题玩玩，题目描述很露骨，直接就看出来是什么东西了。<br/>
不过，为刷这题，有更多的东西值得说说。<br/><br/><font color="#0000ff">先是一组数据</font><br/><table cellspacing="0" cellpadding="0" border="0" width="527" style="border-collapse: collapse; width: 395pt;"><col width="72" span="5" style="width: 54pt;"/><col width="95" style="width: 71pt;"/><col width="72" style="width: 54pt;"/><tbody><tr height="19" style="height: 14.25pt;"><td height="19" width="72" style="height: 14.25pt; width: 54pt;">Accepted</td>
            <td width="72" style="width: 54pt;">620K</td>
            <td width="72" style="width: 54pt;">32MS</td>
            <td width="72" style="width: 54pt;">G++</td>
            <td width="72" style="width: 54pt;">1212B</td>
            <td align="right" width="95" style="width: 71pt;" class="xl24">2009/5/19</td>
            <td align="right" width="72" style="width: 54pt;" class="xl25">9:55:27</td>
        </tr><tr height="19" style="height: 14.25pt;"><td height="19" style="height: 14.25pt;">Accepted</td>
            <td>816K</td>
            <td>47MS</td>
            <td>G++</td>
            <td>1194B</td>
            <td align="right" class="xl24">2009/5/19</td>
            <td align="right" class="xl25">9:54:11</td>
        </tr><tr height="19" style="height: 14.25pt;"><td height="19" style="height: 14.25pt;">Accepted</td>
            <td>816K</td>
            <td>297MS</td>
            <td>G++</td>
            <td>994B</td>
            <td align="right" class="xl24">2009/5/19</td>
            <td align="right" class="xl25">9:51:30</td>
        </tr><tr height="19" style="height: 14.25pt;"><td height="19" style="height: 14.25pt;">Accepted</td>
            <td>816K</td>
            <td>297MS</td>
            <td>G++</td>
            <td>876B</td>
            <td align="right" class="xl24">2009/5/19</td>
            <td align="right" class="xl25">9:48:48</td>
        </tr><tr height="19" style="height: 14.25pt;"><td height="19" style="height: 14.25pt;">Accepted</td>
            <td>816K</td>
            <td>313MS</td>
            <td>G++</td>
            <td>848B</td>
            <td align="right" class="xl24">2009/5/19</td>
            <td align="right" class="xl25">9:46:26</td>
        </tr></tbody></table><br/><font color="#0000ff">看时间吧，从下到上依次是：</font><br/><br/>
AC1，普通<br/>
AC2，对初始化进行优化，少memset了一些地方，快了10多ms<br/>
AC3，加入启发式合并，没发现变快<br/>
AC4，加入外挂，刷到47ms，已经很快了<br/>
AC5，又去掉启发式合并，32ms，成功刷版<br/><br/><font color="#0000ff">于是得出以下结论：</font><br/><br/>
1.<br/>
memset少一点可以提高效率，<br/>
（估计32ms和后面47ms的就是这里有点差异）<br/>
但要小心，是以可能出错为代价的。。不要写囧。（我曾经在这个问题上<a href="http://hi.baidu.com/hplonline/blog/item/8fbb05b34d84d6afd8335af6.html" target="_blank">囧过多次</a>了）<br/><br/>
2.<br/>
启发式合并是一个<font color="#ff0000">理论上</font>很好的东西，但是可能由于加入过多的<font color="#ff0000">if</font>，<br/>
以及<font color="#ff0000">路径压缩本身就很快</font>的原因，导致没有啥优势。<br/><br/>
3.<br/><a href="http://hi.baidu.com/hplonline/blog/item/68db005503fdd1ccb645aeb3.html" target="_blank">外挂</a>是个很强的东西。<br/><br/><font color="#0000ff">并查集的代码：</font><br/><br/>
以后有的哥们是搜并查集进来的。。<br/>
要是看到我一堆废话肯定会起火的。。<br/>
于是给出一套，写得不好看也不丑，用起来手感很好。<br/><br/>
        const int MAXN = 50010 ;<br/><br/>
        int f[MAXN] ;<br/>
        //int r[MAXN] ;<br/><br/>
        void init_set(int n){<br/>
              memset(f + 1 , 0 , sizeof(f[0]) * n) ;<br/>
        //      memset(r + 1 , 0 , sizeof(f[0]) * n) ;<br/>
        }<br/><br/>
        int find_set(int x){<br/>
              int fa = x , t ;<br/>
              while ( f[fa] ) fa = f[fa] ;<br/>
              while ( f[x] ){<br/>
                    t = x ;<br/>
                    x = f[x] ;<br/>
                    f[t] = fa ;<br/>
              }<br/>
              return fa ;<br/>
        }<br/><br/>
        int union_set(int a , int b){<br/>
              a = find_set(a) ;<br/>
              b = find_set(b) ;<br/>
              if ( a == b ){<br/>
                    return 0 ;<br/>
              }else{<br/>
                 <font color="#ff0000"> f[a] = b ;</font><br/>
        //            if ( r[a] &gt; r[b] ) {<br/>
        //                  f[b] = a ;      <br/>
        //            }else{<br/>
        //                  f[a] = b ;<br/>
        //                  if ( r[a] == r[b] ){<br/>
        //                        r[b] ++ ;<br/>
        //                  }<br/>
        //            }<br/>
                    return 1 ;<br/>
              }<br/>
        }<br/><br/>
其中注释掉的就是启发式合并的地方，<br/>
非要用启发式合并的话，就把红色的注释掉，把注释掉的变有效<br/><font color="#ff0000">点的下标是从1</font>开始的<br/><br/><font color="#0000ff">一个火星发现：</font><br/><br/>
  <font color="#ff0000">      #ifndef ONLINE_JUDGE<br/>
              freopen("in.txt","r",stdin) ;<br/>
        #endif</font><br/><br/>
ONLINE_JUDGE是个很好用的宏。。<br/>
这样就不用担心有的时候搞忘把freopen注释掉了。。。。
