---
layout: post
title: "分离两个正弦信号。（MATLAB模拟）"
date: 2009-12-29  14:03
comments: true
categories: tech
tags: ["Matlab"]
_baiduhi_id: 0ffd80827cfc679bf703a697.html
_baiduhi_category: Matlab
---

<p>(hplonline)2009.12.29</p>
<p><font color="#0000ff">条件：</font></p>
<p>1.次信号的频率离主信号有10%的差异<br/>
2.次信号的幅值为主信号的1/5左右</p>
<p><font color="#0000ff">原理概述：</font></p>
<p>对混合信号进行采样，<br/>
做FFT，在频谱上能看到分离的两簇。<br/>
从频谱上将信号分离，<br/>
再做IFFT，即可得到两信号的离散序列。</p>
<p>从离散序列到模拟信号，<br/>
有两种思路：<br/>
一是做D/A，然后低通滤波。<br/>
二是得到幅值和频率等参数，交给两个VCO来输出信号。</p>
<p>不过本模拟是纯粹原理上的，<br/>
就不做具体的恢复部分了。<br/>
仅仅关注如何在频谱上鉴别两个信号。</p>
<p><font color="#0000ff">分离算法：</font></p>
<p>原主次信号如图</p>
<p><span><img class="blogimg" border="0" small="0" src="http://hiphotos.baidu.com/hplonline/pic/item/30d5b20efb4cbad737d122df.jpg"/><br/></span></p>
<p>FFT变换后的频谱（已经在集中位置进行了放大，对称位置忽略了）</p>
<p><span><img class="blogimg" border="0" small="0" src="http://hiphotos.baidu.com/hplonline/pic/item/8ed7f2dc15a15491cc1166d8.jpg"/><br/></span></p>
<p>可以明显看到有两簇频谱。<br/>
但除了两个主峰外，还有若干小的旁瓣。</p>
<p>这里采用的是一个简单的三点鉴峰算法。<br/>
即如果一点比左右两点的幅值高，那么就认为他是一个峰。</p>
<p>先把所有的峰都提取出来，<br/>
这个序列可以想象成原频谱的一个“包络”。<br/>
绘制出的形状如下：</p>
<p><span><img class="blogimg" border="0" small="0" src="http://hiphotos.baidu.com/hplonline/pic/item/76e3c33db06cd5f79e3d62da.jpg"/><br/></span></p>
<p>这样就可以排除旁瓣纹波的干扰，<br/>
看到两个更独立的峰。<br/>
对这个峰的序列继续使用三点鉴峰算法，<br/>
即可提取出主次信号的峰值频率位置p1和p2。</p>
<p>分离操作也是从简的，<br/>
直接取pmid=(p1+p2)/2，<br/>
然后以pmid把频谱分成两段。<br/>
效果如下图：</p>
<p><span><img class="blogimg" border="0" small="0" src="http://hiphotos.baidu.com/hplonline/pic/item/83afdc88049969a4a5c272a5.jpg"/><br/></span></p>
<p><font color="#0000ff">信号恢复效果的讨论：</font></p>
<p>由于为了提高频谱分辨率，<br/>
对N点的信号做的是M点的fft（M&gt;N)。<br/>
对上面分离的频谱做IFFT后，<br/>
得到的也应该是M点的序列。<br/>
这个序列应该是原序列在后面补零所产生的，<br/>
我们只取前面的N点就可以了。</p>
<p>具体效果如下图</p>
<p><span><img class="blogimg" border="0" small="0" src="http://hiphotos.baidu.com/hplonline/pic/item/1d1e3badbf4898394a36d6a6.jpg"/><br/></span></p>
<p>可以看到信号的整体形状比较怪异，<br/>
但中间部分貌似还行。<br/>
在中部放大后的效果如图</p>
<p><span><img class="blogimg" border="0" small="0" src="http://hiphotos.baidu.com/hplonline/pic/item/a71758660eb1e714aa184ca6.jpg"/><br/></span></p>
<p>经过与原主次信号对比，<br/>
发现幅值和频率基本上是一致的。</p>
<p><font color="#0000ff">遗留问题：</font></p>
<p>1.相关参数需要根据实际使用的器件来定，再次仿真</p>
<p>2.当采样率相对主信号很高的时候，两个信号的频谱会压在一起<br/>
所以需要考虑根据实际情况调整采样率。<br/>
或者调整其他相关参数，如一帧的点数（N)，变换的点数（M)</p>
<p>程序文件<a target="_blank" href="http://www.box.net/shared/k8dmu7e316">下载</a></p>
<p> </p>
