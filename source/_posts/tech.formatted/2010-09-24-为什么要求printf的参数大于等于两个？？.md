---
layout: post
title: "为什么要求printf的参数大于等于两个？？"
date: 2010-09-24  22:13
comments: true
categories: tech
tags: ["c","c++"]
_baiduhi_id: d8001fcef6a35d37b700c80d.html
_baiduhi_category: c&c++
---

(hplonline)2010.9.24<br/><br/>
之前用某代码检测工具的时候，被扣分了。<br/>
查看错误log发现是printf的参数只有一个。<br/><br/>
其实我只是简单地用printf打印一些信息到console，<br/>
中间也不涉及格式化其他变量，<br/>
故一直没有想明白这样做的意义何在。<br/>
大致就像这样吧：printf("something") ;<br/><br/>
printf确实有些危险的地方，<br/>
比如格式字符和后面的压栈的变量不匹配。<br/>
这样，在有指针操作的时候可能出问题，比如%s，<br/>
如果后面没有对应有效的指针，就可能打出一些古怪的东西。<br/><br/>
今天跟jingmi吃饭，说到了这个问题，原来主要是考虑到“%”的转义问题。<br/><br/>
比如传给printf的可能并非一个字符常量，而是一个变量。<br/>
直接 printf(s); 最大的问题就是s[]里面可能有“%”。<br/>
而s处于格式化字符串的位置，所以解析上会有问题。<br/>
而客户代码在调用的时候，没有理由用两个%去先做一次替换，<br/>
总不能假定我传过去的东西总是放在格式字符串的位置吧。<br/>
所以该代码检测工具也是有理的，提醒大家注意一下仅打印纯字符信息的情况。<br/>
最好是稍作修改：printf("%s",s); 这样会规避掉许多问题。<br/><br/>
